 <!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø¨Ø·Ø§Ù‚Ø© ØªÙ‡Ù†Ø¦Ø© Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø±</title>
  <style>
    body {
      text-align: center;
      font-family: Tahoma, Arial, sans-serif;
      direction: rtl;
      background-color: #f0f0f0;
      margin: 0;
      padding: 20px;
    }
    .container {
      margin: auto;
      max-width: 800px;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
    }
    input, button {
      margin: 10px;
      padding: 8px;
      font-size: 16px;
    }
    #canvas {
      border: 1px solid #ccc;
      margin-top: 20px;
      display: none; /* Ø³ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø±Ø³Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
    }
    #downloadLink {
      display: none; /* Ø³ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø±Ø³Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
      margin-top: 20px;
      font-size: 18px;
      text-decoration: none;
      background-color: #4CAF50;
      color: #fff;
      padding: 10px 20px;
      border-radius: 5px;
    }
    #downloadLink:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸ‰ Ø§ØµÙ†Ø¹ Ø¨Ø·Ø§Ù‚Ø© ØªÙ‡Ù†Ø¦Ø© Ø®Ø§ØµØ© Ø¨Ùƒ Ù…Ø¹ Ù…ÙƒØªØ¨ Ø§Ù„Ø£Ø³ØªØ§Ø° ØµØ¨Ø­Ù‰ Ø§Ù„Ø´Ù„Ù…Ù‡! ğŸ‰</h2>
    <div>
      <input type="text" id="userName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
      <input type="file" id="userImage" accept="image/*">
      <button onclick="generateCard()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‡Ù†Ø¦Ø©</button>
    </div>

    <!-- Canvas Ø£ÙƒØ¨Ø± Ù„ÙŠØªØ³Ø¹ Ø§Ù„ØªØµÙ…ÙŠÙ… -->
    <canvas id="canvas" width="800" height="1000"></canvas>
    <br>
    <a id="downloadLink" download="ØªÙ‡Ù†Ø¦Ø©_Ø¹ÙŠØ¯_Ø§Ù„ÙØ·Ø±.png">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‡Ù†Ø¦Ø©</a>
  </div>

  <script>
    function generateCard() {
      const name = document.getElementById("userName").value.trim();
      const imageInput = document.getElementById("userImage").files[0];

      if (!name || !imageInput) {
        alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±ÙØ¹ ØµÙˆØ±Ø©!");
        return;
      }

      // Ù†Ø³ØªØ®Ø¯Ù… FileReader Ù„Ù‚Ø±Ø§Ø¡Ø© ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      const reader = new FileReader();
      reader.onload = function (event) {
        const userImg = new Image();
        userImg.src = event.target.result;

        // ØµÙˆØ±Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© (ØªØµÙ…ÙŠÙ… Ø´Ø¨ÙŠÙ‡ Ø¨Ø§Ù„Ø°ÙŠ Ø£Ø±Ø³Ù„ØªÙ‡)
        const bg = new Image();
        bg.src = "bg.png";

        // ØµÙˆØ±Ø© Ø§Ù„Ù„ÙˆØ¬Ùˆ
        const logo = new Image();
        logo.src = "logo.png";

        // Ù†Ù†ØªØ¸Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ± Ø§Ù„Ø«Ù„Ø§Ø«Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø±Ø³Ù…
        let imagesLoaded = 0;
        userImg.onload = onImageLoad;
        bg.onload = onImageLoad;
        logo.onload = onImageLoad;

        function onImageLoad() {
          imagesLoaded++;
          if (imagesLoaded === 3) {
            drawCard(userImg, bg, logo, name);
          }
        }
      };
      reader.readAsDataURL(imageInput);
    }

    function drawCard(userImg, bg, logo, name) {
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");

      // 1) Ø±Ø³Ù… Ø®Ù„ÙÙŠØ© Ø§Ù„ØªØµÙ…ÙŠÙ… Ø¹Ù„Ù‰ ÙƒØ§Ù…Ù„ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù€ Canvas
      ctx.drawImage(bg, 0, 0, canvas.width, canvas.height);

      // 2) Ù‚Øµ ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ø±ÙŠ ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ
      const diameter = 300;  // Ù‚Ø·Ø± Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©
      const radius = diameter / 2;
      const circleCenterX = canvas.width / 2;
      const circleCenterY = 280; // Ø¥Ù†Ø²Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø³ÙÙ„

      // Ø­Ø³Ø§Ø¨ Ø£ØµØºØ± Ø¨Ø¹Ø¯ ÙÙŠ ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù„Ù„Ø§Ù‚ØªØµØ§Øµ Ù…Ø±Ø¨Ù‘Ø¹)
      const side = Math.min(userImg.width, userImg.height);
      const offsetX = (userImg.width - side) / 2;
      const offsetY = (userImg.height - side) / 2;

      ctx.save();
      ctx.beginPath();
      ctx.arc(circleCenterX, circleCenterY, radius, 0, 2 * Math.PI);
      ctx.closePath();
      ctx.clip();

      ctx.drawImage(
        userImg,
        offsetX, offsetY, side, side,
        circleCenterX - radius, circleCenterY - radius, diameter, diameter
      );
      ctx.restore();

      // 3) Ø±Ø³Ù… Ù…Ø³ØªØ·ÙŠÙ„ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø³ÙÙ„ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©
      const rectWidth = 400;
      const rectHeight = 50;
      const rectX = (canvas.width - rectWidth) / 2;
      const rectY = circleCenterY + radius + 30;

      // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø§Ù„ØºØ§Ù…Ù‚
      ctx.fillStyle = "#B8860B"; // Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ ØºØ§Ù…Ù‚
      ctx.fillRect(rectX, rectY, rectWidth, rectHeight);

      // ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù… ÙÙŠ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø¨ÙŠØ¶
      ctx.fillStyle = "#fff";
      ctx.font = "bold 22px Tahoma";
      ctx.textAlign = "center";
      ctx.fillText(name, canvas.width / 2, rectY + 33);

      // 4) ÙƒØªØ§Ø¨Ø© Ø¨Ù‚ÙŠØ© Ø§Ù„Ù†ØµÙˆØµ Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø¨ÙŠØ¶ Ø£Ø³ÙÙ„ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„
      ctx.fillStyle = "#fff";
      ctx.font = "bold 26px Tahoma";
      ctx.fillText("ÙŠÙ‡Ù†Ø¦ÙƒÙ…", canvas.width / 2, rectY + rectHeight + 60);
      ctx.fillText("Ø¨Ø­Ù„ÙˆÙ„ Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø± Ø§Ù„Ù…Ø¨Ø§Ø±Ùƒ", canvas.width / 2, rectY + rectHeight + 100);

      ctx.font = "20px Tahoma";
      ctx.fillText("ÙƒÙ„ Ø¹Ø§Ù… ÙˆØ£Ù†ØªÙ… Ø¨Ø®ÙŠØ±", canvas.width / 2, rectY + rectHeight + 140);
      ctx.fillText("ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ù…Ù†Ø§ ÙˆÙ…Ù†ÙƒÙ… ØµØ§Ù„Ø­ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„", canvas.width / 2, rectY + rectHeight + 170);

      // 5) Ø±Ø³Ù… Ø§Ù„Ù„ÙˆØ¬Ùˆ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ Ø¨Ø­Ø¬Ù… Ø£ÙƒØ¨Ø± (Ø§Ù„Ø¶Ø¹Ù ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª)
      const logoSize = 240;
      const logoX = (canvas.width - logoSize) / 2;
      const logoY = canvas.height - logoSize - 30;
      ctx.drawImage(logo, logoX, logoY, logoSize, logoSize);

      // 6) Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù€ Canvas ÙˆØ±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„
      canvas.style.display = "block";
      const downloadLink = document.getElementById("downloadLink");
      downloadLink.href = canvas.toDataURL("image/png");
      downloadLink.style.display = "inline-block";
    }
  </script>
</body>
</html>
